<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Provides extension methods for consuming HTTP response streams."><meta name="keywords" content="rust, rustlang, rust-lang, ReadResponseExt"><title>isahc::ReadResponseExt - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="https://raw.githubusercontent.com/sagebind/isahc/master/media/icon.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc trait"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../isahc/index.html'><div class='logo-container'><img src='https://raw.githubusercontent.com/sagebind/isahc/master/media/isahc.svg.png' alt='logo'></div></a><p class="location">Trait ReadResponseExt</p><div class="sidebar-elems"><div class="block items"><a class="sidebar-title" href="#required-methods">Required Methods</a><div class="sidebar-links"><a href="#tymethod.copy_to">copy_to</a><a href="#tymethod.json">json</a><a href="#tymethod.text">text</a></div><a class="sidebar-title" href="#provided-methods">Provided Methods</a><div class="sidebar-links"><a href="#method.consume">consume</a><a href="#method.copy_to_file">copy_to_file</a></div><a class="sidebar-title" href="#implementors">Implementors</a></div><p class="location"><a href="index.html">isahc</a></p><div id="sidebar-vars" data-name="ReadResponseExt" data-ty="trait" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Trait <a href="index.html">isahc</a>::<wbr><a class="trait" href="">ReadResponseExt</a><button id="copy-path" onclick="copy_path(this)">⎘</button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/isahc/response.rs.html#94-236" title="goto source code">[src]</a></span></h1><div class="docblock type-decl hidden-by-usual-hider"><pre class="rust trait">pub trait ReadResponseExt&lt;R:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/std/io/trait.Read.html" title="trait std::io::Read">Read</a>&gt; {
    fn <a href="#tymethod.copy_to" class="fnname">copy_to</a>&lt;W:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/std/io/trait.Write.html" title="trait std::io::Write">Write</a>&gt;(&amp;mut self, writer: W) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.text" class="fnname">text</a>(&amp;mut self) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>&gt;;
<div class="item-spacer"></div>    fn <a href="#tymethod.json" class="fnname">json</a>&lt;T&gt;(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, <a class="struct" href="https://docs.rs/serde_json/1.0.64/serde_json/error/struct.Error.html" title="struct serde_json::error::Error">Error</a>&gt;<br>&nbsp;&nbsp;&nbsp; <span class="where">where<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="https://docs.rs/serde/1.0.125/serde/de/trait.DeserializeOwned.html" title="trait serde::de::DeserializeOwned">DeserializeOwned</a></span>;

    fn <a href="#method.consume" class="fnname">consume</a>(&amp;mut self) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt; { ... }
<div class="item-spacer"></div>    fn <a href="#method.copy_to_file" class="fnname">copy_to_file</a>&lt;P:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.AsRef.html" title="trait core::convert::AsRef">AsRef</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/std/path/struct.Path.html" title="struct std::path::Path">Path</a>&gt;&gt;(&amp;mut self, path: P) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt; { ... }
}</pre></div><div class="docblock"><p>Provides extension methods for consuming HTTP response streams.</p>
</div><h2 id="required-methods" class="small-section-header">Required methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><h3 id="tymethod.copy_to" class="method"><code>fn <a href="#tymethod.copy_to" class="fnname">copy_to</a>&lt;W:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/std/io/trait.Write.html" title="trait std::io::Write">Write</a>&gt;(&amp;mut self, writer: W) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt;</code><a class="srclink" href="../src/isahc/response.rs.html#159" title="goto source code">[src]</a></h3><div class="docblock"><p>Copy the response body into a writer.</p>
<p>Returns the number of bytes that were written.</p>
<h1 id="examples" class="section-header"><a href="#examples">Examples</a></h1>
<p>Copying the response into an in-memory buffer:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">isahc::prelude</span>::<span class="kw-2">*</span>;

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">buf</span> <span class="op">=</span> <span class="macro">vec!</span>[];
<span class="ident">isahc::get</span>(<span class="string">&quot;https://example.org&quot;</span>)<span class="question-mark">?</span>.<span class="ident">copy_to</span>(<span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="ident">buf</span>)<span class="question-mark">?</span>;
<span class="macro">println!</span>(<span class="string">&quot;Read {} bytes&quot;</span>, <span class="ident">buf</span>.<span class="ident">len</span>());</pre></div>
</div><h3 id="tymethod.text" class="method"><code>fn <a href="#tymethod.text" class="fnname">text</a>(&amp;mut self) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>&gt;</code><a class="srclink" href="../src/isahc/response.rs.html#213" title="goto source code">[src]</a></h3><div class="docblock"><p>Read the response body as a string.</p>
<p>The encoding used to decode the response body into a string depends on
the response. If the body begins with a <a href="https://en.wikipedia.org/wiki/Byte_order_mark">Byte Order Mark
(BOM)</a>, then UTF-8,
UTF-16LE or UTF-16BE is used as indicated by the BOM. If no BOM is
present, the encoding specified in the <code>charset</code> parameter of the
<code>Content-Type</code> header is used if present. Otherwise UTF-8 is assumed.</p>
<p>If the response body contains any malformed characters or characters not
representable in UTF-8, the offending bytes will be replaced with
<code>U+FFFD REPLACEMENT CHARACTER</code>, which looks like this: �.</p>
<p>This method consumes the entire response body stream and can only be
called once.</p>
<h1 id="availability" class="section-header"><a href="#availability">Availability</a></h1>
<p>This method is only available when the
<a href="index.html#text-decoding"><code>text-decoding</code></a> feature is enabled, which it
is by default.</p>
<h1 id="examples-1" class="section-header"><a href="#examples-1">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">isahc::prelude</span>::<span class="kw-2">*</span>;

<span class="kw">let</span> <span class="ident">text</span> <span class="op">=</span> <span class="ident">isahc::get</span>(<span class="string">&quot;https://example.org&quot;</span>)<span class="question-mark">?</span>.<span class="ident">text</span>()<span class="question-mark">?</span>;
<span class="macro">println!</span>(<span class="string">&quot;{}&quot;</span>, <span class="ident">text</span>);</pre></div>
</div><h3 id="tymethod.json" class="method"><code>fn <a href="#tymethod.json" class="fnname">json</a>&lt;T&gt;(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, <a class="struct" href="https://docs.rs/serde_json/1.0.64/serde_json/error/struct.Error.html" title="struct serde_json::error::Error">Error</a>&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="https://docs.rs/serde/1.0.125/serde/de/trait.DeserializeOwned.html" title="trait serde::de::DeserializeOwned">DeserializeOwned</a>,&nbsp;</span></code><a class="srclink" href="../src/isahc/response.rs.html#233-235" title="goto source code">[src]</a></h3><div class="docblock"><p>Deserialize the response body as JSON into a given type.</p>
<h1 id="availability-1" class="section-header"><a href="#availability-1">Availability</a></h1>
<p>This method is only available when the <a href="index.html#json"><code>json</code></a> feature
is enabled.</p>
<h1 id="examples-2" class="section-header"><a href="#examples-2">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">isahc::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">serde_json::Value</span>;

<span class="kw">let</span> <span class="ident">json</span>: <span class="ident">Value</span> <span class="op">=</span> <span class="ident">isahc::get</span>(<span class="string">&quot;https://httpbin.org/json&quot;</span>)<span class="question-mark">?</span>.<span class="ident">json</span>()<span class="question-mark">?</span>;
<span class="macro">println!</span>(<span class="string">&quot;author: {}&quot;</span>, <span class="ident">json</span>[<span class="string">&quot;slideshow&quot;</span>][<span class="string">&quot;author&quot;</span>]);</pre></div>
</div></div><span class="loading-content">Loading content...</span><h2 id="provided-methods" class="small-section-header">Provided methods<a href="#provided-methods" class="anchor"></a></h2><div class="methods"><h3 id="method.consume" class="method"><code>fn <a href="#method.consume" class="fnname">consume</a>(&amp;mut self) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class="srclink" href="../src/isahc/response.rs.html#137-141" title="goto source code">[src]</a></h3><div class="docblock"><p>Read any remaining bytes from the response body stream and discard them
until the end of the stream is reached. It is usually a good idea to
call this method before dropping a response if you know you haven’t read
the entire response body.</p>
<h1 id="background" class="section-header"><a href="#background">Background</a></h1>
<p>By default, if a response stream is dropped before it has been
completely read from, then that HTTP connection will be terminated.
Depending on which version of HTTP is being used, this may require
closing the network connection to the server entirely. This can result
in sub-optimal performance for making multiple requests, as it prevents
Isahc from keeping the connection alive to be reused for subsequent
requests.</p>
<p>If you are downloading a file on behalf of a user and have been
requested to cancel the operation, then this is probably what you want.
But if you are making many small API calls to a known server, then you
may want to call <code>consume()</code> before dropping the response, as reading a
few megabytes off a socket is usually more efficient in the long run
than taking a hit on connection reuse, and opening new connections can
be expensive.</p>
<p>Note that in HTTP/2 and newer, it is not necessary to close the network
connection in order to interrupt the transfer of a particular response.
If you know that you will be using only HTTP/2 or newer, then calling
this method is probably unnecessary.</p>
<h1 id="examples-3" class="section-header"><a href="#examples-3">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">isahc::prelude</span>::<span class="kw-2">*</span>;

<span class="kw">let</span> <span class="kw-2">mut</span> <span class="ident">response</span> <span class="op">=</span> <span class="ident">isahc::get</span>(<span class="string">&quot;https://example.org&quot;</span>)<span class="question-mark">?</span>;

<span class="macro">println!</span>(<span class="string">&quot;Status: {}&quot;</span>, <span class="ident">response</span>.<span class="ident">status</span>());
<span class="macro">println!</span>(<span class="string">&quot;Headers: {:#?}&quot;</span>, <span class="ident">response</span>.<span class="ident">headers</span>());

<span class="comment">// Read and discard the response body until the end.</span>
<span class="ident">response</span>.<span class="ident">consume</span>()<span class="question-mark">?</span>;</pre></div>
</div><h3 id="method.copy_to_file" class="method"><code>fn <a href="#method.copy_to_file" class="fnname">copy_to_file</a>&lt;P:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.AsRef.html" title="trait core::convert::AsRef">AsRef</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/std/path/struct.Path.html" title="struct std::path::Path">Path</a>&gt;&gt;(&amp;mut self, path: P) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt;</code><a class="srclink" href="../src/isahc/response.rs.html#177-179" title="goto source code">[src]</a></h3><div class="docblock"><p>Write the response body to a file.</p>
<p>This method makes it convenient to download a file using a GET request
and write it to a file synchronously in a single chain of calls.</p>
<p>Returns the number of bytes that were written.</p>
<h1 id="examples-4" class="section-header"><a href="#examples-4">Examples</a></h1>
<div class="example-wrap"><pre class="rust rust-example-rendered">
<span class="kw">use</span> <span class="ident">isahc::prelude</span>::<span class="kw-2">*</span>;

<span class="ident">isahc::get</span>(<span class="string">&quot;https://httpbin.org/image/jpeg&quot;</span>)<span class="question-mark">?</span>
    .<span class="ident">copy_to_file</span>(<span class="string">&quot;myimage.jpg&quot;</span>)<span class="question-mark">?</span>;</pre></div>
</div></div><span class="loading-content">Loading content...</span><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div class="item-list" id="implementors-list"><h3 id="impl-ReadResponseExt%3CR%3E" class="impl"><code class="in-band">impl&lt;R:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/std/io/trait.Read.html" title="trait std::io::Read">Read</a>&gt; <a class="trait" href="../isahc/trait.ReadResponseExt.html" title="trait isahc::ReadResponseExt">ReadResponseExt</a>&lt;R&gt; for <a class="struct" href="../isahc/struct.Response.html" title="struct isahc::Response">Response</a>&lt;R&gt;</code><a href="#impl-ReadResponseExt%3CR%3E" class="anchor"></a><a class="srclink" href="../src/isahc/response.rs.html#238-255" title="goto source code">[src]</a></h3><div class="impl-items"><h4 id="method.copy_to" class="method hidden trait-impl"><code>fn <a href="#tymethod.copy_to" class="fnname">copy_to</a>&lt;W:&nbsp;<a class="trait" href="https://doc.rust-lang.org/nightly/std/io/trait.Write.html" title="trait std::io::Write">Write</a>&gt;(&amp;mut self, writer: W) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u64.html">u64</a>&gt;</code><a href="#method.copy_to" class="anchor"></a><a class="srclink" href="../src/isahc/response.rs.html#239-241" title="goto source code">[src]</a></h4><h4 id="method.text" class="method hidden trait-impl"><code>fn <a href="#tymethod.text" class="fnname">text</a>(&amp;mut self) -&gt; <a class="type" href="https://doc.rust-lang.org/nightly/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>&gt;</code><a href="#method.text" class="anchor"></a><a class="srclink" href="../src/isahc/response.rs.html#244-246" title="goto source code">[src]</a></h4><h4 id="method.json" class="method hidden trait-impl"><code>fn <a href="#tymethod.json" class="fnname">json</a>&lt;D&gt;(&amp;mut self) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;D, <a class="struct" href="https://docs.rs/serde_json/1.0.64/serde_json/error/struct.Error.html" title="struct serde_json::error::Error">Error</a>&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;D: <a class="trait" href="https://docs.rs/serde/1.0.125/serde/de/trait.DeserializeOwned.html" title="trait serde::de::DeserializeOwned">DeserializeOwned</a>,&nbsp;</span></code><a href="#method.json" class="anchor"></a><a class="srclink" href="../src/isahc/response.rs.html#249-254" title="goto source code">[src]</a></h4></div></div><span class="loading-content">Loading content...</span><script type="text/javascript" src="../implementors/isahc/trait.ReadResponseExt.js" async></script></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="isahc" data-search-js="../search-index.js"></div>
    <script src="../main.js"></script></body></html>