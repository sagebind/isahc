<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Provides extension methods for consuming asynchronous HTTP response streams."><meta name="keywords" content="rust, rustlang, rust-lang, AsyncReadResponseExt"><title>AsyncReadResponseExt in isahc - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="sidebar-items.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" href="https://raw.githubusercontent.com/sagebind/isahc/master/media/icon.png"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../isahc/index.html"><div class="logo-container"><img src="https://raw.githubusercontent.com/sagebind/isahc/master/media/isahc.svg.png" alt="logo"></div></a><h2 class="location"></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../isahc/index.html"><div class="logo-container">
                    <img src="https://raw.githubusercontent.com/sagebind/isahc/master/media/isahc.svg.png" alt="logo"></div></a><h2 class="location"><a href="#">AsyncReadResponseExt</a></h2><div class="sidebar-elems"><section><div class="block"><h3 class="sidebar-title"><a href="#required-methods">Required Methods</a></h3><ul><li><a href="#tymethod.bytes">bytes</a></li><li><a href="#tymethod.consume">consume</a></li><li><a href="#tymethod.copy_to">copy_to</a></li><li><a href="#tymethod.json">json</a></li><li><a href="#tymethod.text">text</a></li></ul></div><div class="block"><h3 class="sidebar-title"><a href="#implementors">Implementors</a></h3></div></section><h2 class="location"><a href="index.html">In isahc</a></h2></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../isahc/index.html">
                        <img src="https://raw.githubusercontent.com/sagebind/isahc/master/media/isahc.svg.png" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></div></form></nav></div><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Trait <a href="index.html">isahc</a>::<wbr><a class="trait" href="#">AsyncReadResponseExt</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/isahc/response.rs.html#311-450">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="item-decl"><pre class="rust trait"><code>pub trait AsyncReadResponseExt&lt;R:&nbsp;AsyncRead + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a>&gt; {
    fn <a href="#tymethod.consume" class="fnname">consume</a>(&amp;mut self) -&gt; ConsumeFuture&lt;'_, R&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.copy_to" class="fnname">copy_to</a>&lt;'a, W&gt;(&amp;'a mut self, writer: W) -&gt; CopyFuture&lt;'a, R, W&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="where">where<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;W: AsyncWrite + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> + 'a</span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.bytes" class="fnname">bytes</a>(&amp;mut self) -&gt; BytesFuture&lt;'_, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut </a>R&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.text" class="fnname">text</a>(&amp;mut self) -&gt; TextFuture&lt;'_, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut </a>R&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.json" class="fnname">json</a>&lt;T&gt;(&amp;mut self) -&gt; JsonFuture&lt;'_, R, T&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="where">where<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="https://docs.rs/serde/1.0.145/serde/de/trait.DeserializeOwned.html" title="trait serde::de::DeserializeOwned">DeserializeOwned</a></span>;
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Provides extension methods for consuming asynchronous HTTP response streams.</p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.consume" class="method has-srclink"><a class="srclink rightside" href="../src/isahc/response.rs.html#355">source</a><h4 class="code-header">fn <a href="#tymethod.consume" class="fnname">consume</a>(&amp;mut self) -&gt; ConsumeFuture&lt;'_, R&gt;</h4></section></summary><div class="docblock"><p>Read any remaining bytes from the response body stream and discard them
until the end of the stream is reached. It is usually a good idea to
call this method before dropping a response if you know you haven’t read
the entire response body.</p>
<h5 id="background"><a href="#background">Background</a></h5>
<p>By default, if a response stream is dropped before it has been
completely read from, then that HTTP connection will be terminated.
Depending on which version of HTTP is being used, this may require
closing the network connection to the server entirely. This can result
in sub-optimal performance for making multiple requests, as it prevents
Isahc from keeping the connection alive to be reused for subsequent
requests.</p>
<p>If you are downloading a file on behalf of a user and have been
requested to cancel the operation, then this is probably what you want.
But if you are making many small API calls to a known server, then you
may want to call <code>consume()</code> before dropping the response, as reading a
few megabytes off a socket is usually more efficient in the long run
than taking a hit on connection reuse, and opening new connections can
be expensive.</p>
<p>Note that in HTTP/2 and newer, it is not necessary to close the network
connection in order to interrupt the transfer of a particular response.
If you know that you will be using only HTTP/2 or newer, then calling
this method is probably unnecessary.</p>
<h5 id="examples"><a href="#examples">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>isahc::prelude::<span class="kw-2">*</span>;

<span class="kw">let </span><span class="kw-2">mut </span>response = isahc::get_async(<span class="string">&quot;https://example.org&quot;</span>).<span class="kw">await</span><span class="question-mark">?</span>;

<span class="macro">println!</span>(<span class="string">&quot;Status: {}&quot;</span>, response.status());
<span class="macro">println!</span>(<span class="string">&quot;Headers: {:#?}&quot;</span>, response.headers());

<span class="comment">// Read and discard the response body until the end.
</span>response.consume().<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.copy_to" class="method has-srclink"><a class="srclink rightside" href="../src/isahc/response.rs.html#375-377">source</a><h4 class="code-header">fn <a href="#tymethod.copy_to" class="fnname">copy_to</a>&lt;'a, W&gt;(&amp;'a mut self, writer: W) -&gt; CopyFuture&lt;'a, R, W&gt;<span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;W: AsyncWrite + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> + 'a,</span></h4></section></summary><div class="docblock"><p>Copy the response body into a writer asynchronously.</p>
<p>Returns the number of bytes that were written.</p>
<h5 id="examples-1"><a href="#examples-1">Examples</a></h5>
<p>Copying the response into an in-memory buffer:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>isahc::prelude::<span class="kw-2">*</span>;

<span class="kw">let </span><span class="kw-2">mut </span>buf = <span class="macro">vec!</span>[];
isahc::get_async(<span class="string">&quot;https://example.org&quot;</span>).<span class="kw">await</span><span class="question-mark">?
    </span>.copy_to(<span class="kw-2">&amp;mut </span>buf).<span class="kw">await</span><span class="question-mark">?</span>;
<span class="macro">println!</span>(<span class="string">&quot;Read {} bytes&quot;</span>, buf.len());</code></pre></div>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.bytes" class="method has-srclink"><a class="srclink rightside" href="../src/isahc/response.rs.html#393">source</a><h4 class="code-header">fn <a href="#tymethod.bytes" class="fnname">bytes</a>(&amp;mut self) -&gt; BytesFuture&lt;'_, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut </a>R&gt;</h4></section></summary><div class="docblock"><p>Read the entire response body into memory.</p>
<h5 id="examples-2"><a href="#examples-2">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>isahc::prelude::<span class="kw-2">*</span>;

<span class="kw">let </span>image_bytes = isahc::get_async(<span class="string">&quot;https://httpbin.org/image/jpeg&quot;</span>)
    .<span class="kw">await</span><span class="question-mark">?
    </span>.bytes()
    .<span class="kw">await</span><span class="question-mark">?</span>;</code></pre></div>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.text" class="method has-srclink"><a class="srclink rightside" href="../src/isahc/response.rs.html#418">source</a><h4 class="code-header">fn <a href="#tymethod.text" class="fnname">text</a>(&amp;mut self) -&gt; TextFuture&lt;'_, <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut </a>R&gt;</h4></section></summary><span class="item-info"><div class="stab portability">Available on <strong>crate feature <code>text-decoding</code></strong> only.</div></span><div class="docblock"><p>Read the response body as a string asynchronously.</p>
<p>This method consumes the entire response body stream and can only be
called once.</p>
<h5 id="availability"><a href="#availability">Availability</a></h5>
<p>This method is only available when the
<a href="index.html#text-decoding"><code>text-decoding</code></a> feature is enabled, which it
is by default.</p>
<h5 id="examples-3"><a href="#examples-3">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>isahc::prelude::<span class="kw-2">*</span>;

<span class="kw">let </span>text = isahc::get_async(<span class="string">&quot;https://example.org&quot;</span>).<span class="kw">await</span><span class="question-mark">?
    </span>.text().<span class="kw">await</span><span class="question-mark">?</span>;
<span class="macro">println!</span>(<span class="string">&quot;{}&quot;</span>, text);</code></pre></div>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.json" class="method has-srclink"><a class="srclink rightside" href="../src/isahc/response.rs.html#447-449">source</a><h4 class="code-header">fn <a href="#tymethod.json" class="fnname">json</a>&lt;T&gt;(&amp;mut self) -&gt; JsonFuture&lt;'_, R, T&gt;<span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: <a class="trait" href="https://docs.rs/serde/1.0.145/serde/de/trait.DeserializeOwned.html" title="trait serde::de::DeserializeOwned">DeserializeOwned</a>,</span></h4></section></summary><span class="item-info"><div class="stab portability">Available on <strong>crate feature <code>json</code></strong> only.</div></span><div class="docblock"><p>Deserialize the response body as JSON into a given type.</p>
<h5 id="caveats"><a href="#caveats">Caveats</a></h5>
<p>Unlike its <a href="trait.ReadResponseExt.html#tymethod.json">synchronous equivalent</a>, this method
reads the entire response body into memory before attempting
deserialization. This is due to a Serde limitation since incremental
partial deserializing is not supported.</p>
<h5 id="availability-1"><a href="#availability-1">Availability</a></h5>
<p>This method is only available when the <a href="index.html#json"><code>json</code></a> feature
is enabled.</p>
<h5 id="examples-4"><a href="#examples-4">Examples</a></h5>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>isahc::prelude::<span class="kw-2">*</span>;
<span class="kw">use </span>serde_json::Value;

<span class="kw">let </span>json: Value = isahc::get_async(<span class="string">&quot;https://httpbin.org/json&quot;</span>).<span class="kw">await</span><span class="question-mark">?
    </span>.json().<span class="kw">await</span><span class="question-mark">?</span>;
<span class="macro">println!</span>(<span class="string">&quot;author: {}&quot;</span>, json[<span class="string">&quot;slideshow&quot;</span>][<span class="string">&quot;author&quot;</span>]);</code></pre></div>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div id="implementors-list"><section id="impl-AsyncReadResponseExt%3CR%3E-for-Response%3CR%3E" class="impl has-srclink"><a class="srclink rightside" href="../src/isahc/response.rs.html#452-512">source</a><a href="#impl-AsyncReadResponseExt%3CR%3E-for-Response%3CR%3E" class="anchor"></a><h3 class="code-header">impl&lt;R:&nbsp;AsyncRead + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a>&gt; <a class="trait" href="trait.AsyncReadResponseExt.html" title="trait isahc::AsyncReadResponseExt">AsyncReadResponseExt</a>&lt;R&gt; for <a class="struct" href="struct.Response.html" title="struct isahc::Response">Response</a>&lt;R&gt;</h3></section></div><script src="../implementors/isahc/response/trait.AsyncReadResponseExt.js" data-ignore-extern-crates="http" async></script></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="isahc" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.0-nightly (81f391930 2022-10-09)" ></div></body></html>